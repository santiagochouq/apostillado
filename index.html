<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador y Verificador de Apostilla - Bolivia</title>
    <!-- Tailwind CSS para el diseño -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Bibliotecas para QR y PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .bg-apostilla {
            background-image: url('/images/attachments-gen-images-public-cloudy-sky-background.jpg');
            background-size: cover;
            background-attachment: fixed;
        }
        .print-area { background: rgb(230, 224, 224); width: 210mm; min-height: 297mm; margin: auto; padding: 20mm; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        @media print { .no-print { display: none; } .print-area { box-shadow: none; margin: 0; padding: 10mm; } }
    </style>
    <link rel="stylesheet" href="style.css">

</head>
<body class="bg-gray-100 min-h-screen">

    <!-- SECCIÓN 1: FORMULARIO DE EDICIÓN (GENERADOR) -->
    <div id="generator-section" class="container mx-auto py-10 px-4 no-print">
        <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden">
            <div class="bg-blue-600 p-6 text-white text-center">
                <h1 class="text-2xl font-bold uppercase">Generador de Apostilla Bolivia</h1>
                <p class="opacity-90">Completa los datos para generar el enlace y QR</p>
            </div>
            
            <form id="apostilla-form" class="p-8 grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Datos del Solicitante -->
                <div class="space-y-4 md:col-span-2 border-b pb-4">
                    <h2 class="text-lg font-semibold text-blue-800">1. Datos del Solicitante</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Nombre del Solicitante</label>
                            <input type="text" name="solicitante" value="MICHELLE ESMERALDA PAREDES SUAREZ" class="mt-1 block w-full border border-gray-300 rounded-md p-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Número de Documento</label>
                            <input type="text" name="doc_solicitante" value="13841473" class="mt-1 block w-full border border-gray-300 rounded-md p-2">
                        </div>
                    </div>
                </div>

                <!-- Firmas y Cargos -->
                <div>
                    <label class="block text-sm font-medium text-gray-700">2. Ha sido firmado por (Nombre)</label>
                    <input type="text" name="firmado_por" value="MARTHA JANETH SAAVEDRA GOMEZ" class="mt-1 block w-full border border-gray-300 rounded-md p-2">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">3. En calidad de (Cargo)</label>
                    <input type="text" name="calidad_de" value="PRESIDENTA DEL TDJ COCHABAMBA" class="mt-1 block w-full border border-gray-300 rounded-md p-2">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">4. Revestido del sello de</label>
                    <input type="text" name="sello_de" value="ORGANO JUDICIAL" class="mt-1 block w-full border border-gray-300 rounded-md p-2">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">5. Lugar (Ciudad)</label>
                    <input type="text" name="lugar" value="COCHABAMBA" class="mt-1 block w-full border border-gray-300 rounded-md p-2">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">6. Fecha (DD/MM/AAAA)</label>
                    <input type="text" name="fecha" value="24/12/2025" class="mt-1 block w-full border border-gray-300 rounded-md p-2">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">7. Por (Funcionario Cancillería)</label>
                    <input type="text" name="por_funcionario" value="RENE JHASMANI VARGAS SANCHEZ" class="mt-1 block w-full border border-gray-300 rounded-md p-2">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">8. Bajo el número</label>
                    <input type="text" name="numero_tramite" value="1334045" class="mt-1 block w-full border border-gray-300 rounded-md p-2">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Código de Seguridad</label>
                    <input type="text" name="codigo_seguridad" value="YHJMXLHXNR" class="mt-1 block w-full border border-gray-300 rounded-md p-2 uppercase">
                </div>

                <div class="md:col-span-2 pt-6">
                    <button type="button" onclick="generateApostilla()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg transition-colors">
                        GENERAR VENTANA DE VERIFICACIÓN Y QR
                    </button>
                     <div id="qrcode" class="bg-white p-2 rounded shadow-md hidden md:block"></div>
            </div>
                </div>
            </form>
        </div>
    </div>

    <!-- SECCIÓN 2: VENTANA DE VERIFICACIÓN (RESULTADO) -->
    <div id="viewer-section" class="hidden bg-apostilla min-h-screen py-10 px-4">
        <div class="max-w-4xl mx-auto space-y-6">
            <!-- Botones de acción flotantes -->
            <div class="flex justify-between mb-4 no-print">
                
               

            <!-- Encabezado Principal -->
            <div id="printable-content" class="bg-white rounded-lg p-8 shadow-md border border-gray-200">
                <div class="text-center mb-6">
                    <img src="/IMG/logo.3d9920ef.png" class="h-32 mx-auto mb-2" alt="Escudo Bolivia">
                      <h2 class="text-2xl font-bold text-blue-900 mt-4">Verificación de la Apostilla</h2>
                <p class="text-blue-800 text-sm font-semibold mt-1">A continuación, se procederá a realizar la verificación de la apostilla solicitada.</p>
                    
                </div>

            <!-- Box Solicitante -->
            <div class="bg-[#eef5ff] rounded-lg p-6 shadow-md border border-blue-100">
                <h3 class="text-blue-900 font-bold text-center mb-4 uppercase tracking-wide">
                    AUTORIZACION DE VIAJE AL EXTERIOR (MENOR) (ORGANO JUDICIAL)
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-y-2 text-sm">
                    <div class="flex"><span class="font-bold w-48 text-blue-900">Solicitante</span><span id="res-solicitante" class="text-gray-700 uppercase"></span></div>
                    <div class="flex"><span class="font-bold w-48 text-blue-900">Solicitante número de doc.</span><span id="res-doc" class="text-gray-700"></span></div>
                    <div class="flex"><span class="font-bold w-48 text-blue-900">Fecha de nacimiento</span><span class="text-gray-700">28/03/2010</span></div>
                </div>
            </div>

            <!-- Documento Oficial -->
            <div id="printable-content" class="bg-white rounded-lg p-8 shadow-md border border-gray-200">
                <div class="text-center mb-6">
                    <img src="img/escudo_bolivia.446ac8d8.jpg" class="h-32 mx-auto mb-2" alt="Escudo Bolivia">
                    <h4 class="font-bold text-xs uppercase">Estado Plurinacional de Bolivia</h4>
                    <p class="text-[10px] leading-tight font-medium uppercase text-gray-600">Ministerio de Relaciones Exteriores</p>
                </div>

                <div class="text-[11px] text-justify text-gray-700 mb-6 leading-relaxed">
                    Esta Apostilla certifica únicamente la autenticidad de la firma, la calidad en que el signatario del documento haya actuado y, en su caso, la identidad del sello o timbre del que el documento público esté revestido (Esta Apostilla no certifica el contenido del documento para el cual se expidió) [Esta Apostilla se puede verificar en la dirección siguiente: https://apostilla.rree.gob.bo/.]
                </div>

                <div class="text-center mb-6">
                    <h3 class="text-blue-600 font-bold text-lg">Apostille</h3>
                    <p class="text-blue-600 text-sm font-semibold">(Convention de La Haye du 5 octobre de 1961)</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4 text-[12px]">
                    <div class="flex gap-2"><span class="font-bold w-40">1. País:<br><span class="font-normal text-gray-500 italic">Country/Pays:</span></span> <span class="uppercase">Bolivia</span></div>
                    
                    <div class="md:col-span-2 text-center py-2">
                        <h4 class="text-blue-600 font-bold">El presente documento público</h4>
                        <p class="text-blue-600 text-[10px]">This public document / Le présent acte public</p>
                    </div>

                    <div class="flex gap-2"><span class="font-bold w-40">2. ha sido firmado por:<br><span class="font-normal text-gray-500 italic">has been signed by a été signé par:</span></span> <span id="res-firmado" class="uppercase"></span></div>
                    <div class="flex gap-2"><span class="font-bold w-40">3. quien actúa en calidad de:<br><span class="font-normal text-gray-500 italic">acting in the capacity of agissant en qualité de:</span></span> <span id="res-calidad" class="uppercase"></span></div>
                    <div class="flex gap-2"><span class="font-bold w-40">4. y está revestido del sello / timbre de:<br><span class="font-normal text-gray-500 italic">bears the seal / stamp of: est revêtu du sceau / timbre de:</span></span> <span id="res-sello" class="uppercase"></span></div>
                    
                    <div class="md:col-span-2 text-center py-4">
                        <h4 class="text-bk¿lue-600 font-bold text-lg border-b border-blue-100 pb-1">Certificado<br><span class="text-sm font-medium">Certified / Attesté</span></h4>
                    </div>

                    <div class="flex gap-2"><span class="font-bold w-20">5. en:<br><span class="font-normal text-gray-500 italic">at/à:</span></span> <span id="res-lugar" class="uppercase"></span></div>
                    <div class="flex gap-2"><span class="font-bold w-20">6. el día:<br><span class="font-normal text-gray-500 italic">the/le:</span></span> <span id="res-fecha"></span></div>
                    <div class="flex gap-2 md:col-span-2"><span class="font-bold w-40">7. por:<br><span class="font-normal text-gray-500 italic">by / par:</span></span> <span id="res-por" class="uppercase"></span></div>
                    <div class="flex gap-2 md:col-span-2"><span class="font-bold w-40">8. bajo el número:<br><span class="font-normal text-gray-500 italic">N.º / sous nº:</span></span> <span id="res-numero"></span></div>
                    <div class="flex gap-2 md:col-span-2"><span class="font-bold w-40">9. sello / Timbre:<br><span class="font-normal text-gray-500 italic">Seal/ stamp:</span></span> <span></span></div>
                    <div class="flex gap-2 md:col-span-2"><span class="font-bold w-40">10. Firma:<br><span class="font-normal text-gray-500 italic">Signature:</span></span> <span class="font-bold">FIRMADO DIGITALMENTE</span></div>

                    <div class="md:col-span-2 pt-4 flex gap-2">
                        <span class="font-bold">CÓDIGO DE SEGURIDAD ALFANUMÉRICO:</span>
                        <span id="res-codigo" class="font-bold"></span>
                    </div>
                </div>
            </div>

            <!-- Botón de Descarga PDF -->
            <div class="text-center pt-6 no-print">
                <button onclick="downloadPDF()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-10 rounded-lg shadow-xl transition-all flex items-center gap-2 mx-auto">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                    </svg>
                    Descargar apostilla PDF
                </button>
            </div>
        </div>
    </div>

    <script>
        function generateApostilla() {
            const form = document.getElementById('apostilla-form');
            const formData = new FormData(form);
            
            // Mapear datos al visor
            document.getElementById('res-solicitante').innerText = formData.get('solicitante');
            document.getElementById('res-doc').innerText = formData.get('doc_solicitante');
            document.getElementById('res-firmado').innerText = formData.get('firmado_por');
            document.getElementById('res-calidad').innerText = formData.get('calidad_de');
            document.getElementById('res-sello').innerText = formData.get('sello_de');
            document.getElementById('res-lugar').innerText = formData.get('lugar');
            document.getElementById('res-fecha').innerText = formData.get('fecha');
            document.getElementById('res-por').innerText = formData.get('por_funcionario');
            document.getElementById('res-numero').innerText = formData.get('numero_tramite');
            document.getElementById('res-codigo').innerText = formData.get('codigo_seguridad').toUpperCase();

            // Generar QR (apuntando a la misma página - simulación)
            document.getElementById('qrcode').innerHTML = '';
            new QRCode(document.getElementById("qrcode"), {
                text: window.location.href,
                width: 80,
                height: 80
            });

            // Cambiar vista
            document.getElementById('generator-section').classList.add('hidden');
            document.getElementById('viewer-section').classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        function backToEditor() {
            document.getElementById('generator-section').classList.remove('hidden');
            document.getElementById('viewer-section').classList.add('hidden');
        }

        async function downloadPDF() {
            const { jsPDF } = window.jspdf;
            const element = document.getElementById('viewer-section');
            
            // Ocultar botones para la captura
            const buttons = document.querySelectorAll('.no-print');
            buttons.forEach(b => b.style.display = 'none');

            const canvas = await html2canvas(element, {
                scale: 2,
                useCORS: true,
                backgroundColor: '#f3f4f6'
            });

            const imgData = canvas.toDataURL('image/png');
            const pdf = new jsPDF('p', 'mm', 'a4');
            const imgProps = pdf.getImageProperties(imgData);
            const pdfWidth = pdf.internal.pageSize.getWidth();
            const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;

            pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
            pdf.save(`Apostilla_${document.getElementById('res-numero').innerText}.pdf`);

            // Restaurar botones
            buttons.forEach(b => b.style.display = '');
        }
    </script>
</body>
</html>
